{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/IMAGE%20EDITOR/Image_Editor/backend/lib/cloudinary.ts"],"sourcesContent":["import { v2 as cloudinary } from 'cloudinary';\n\n// Configure Cloudinary\ncloudinary.config({\n  cloud_name: process.env.CLOUDINARY_CLOUD_NAME,\n  api_key: process.env.CLOUDINARY_API_KEY,\n  api_secret: process.env.CLOUDINARY_API_SECRET\n});\n\nexport default cloudinary;\n\n// Helper function to create folder structure in Cloudinary\nexport async function createCloudinaryFolder(folderPath: string) {\n  // Cloudinary creates folders automatically when you upload to them\n  // We'll upload a small transparent 1x1 PNG placeholder\n  const placeholderImage = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg==';\n  \n  try {\n    const result = await cloudinary.uploader.upload(placeholderImage, {\n      folder: folderPath,\n      public_id: '.folder_marker',\n      overwrite: true,\n      invalidate: true,\n      resource_type: 'image'\n    });\n    return { success: true, public_id: result.public_id };\n  } catch (error: any) {\n    console.error(`Error creating folder ${folderPath}:`, error);\n    return { success: false, error: error.message };\n  }\n}\n\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,uBAAuB;AACvB,mHAAU,CAAC,MAAM,CAAC;IAChB,YAAY,QAAQ,GAAG,CAAC,qBAAqB;IAC7C,SAAS,QAAQ,GAAG,CAAC,kBAAkB;IACvC,YAAY,QAAQ,GAAG,CAAC,qBAAqB;AAC/C;uCAEe,mHAAU;AAGlB,eAAe,uBAAuB,UAAkB;IAC7D,mEAAmE;IACnE,uDAAuD;IACvD,MAAM,mBAAmB;IAEzB,IAAI;QACF,MAAM,SAAS,MAAM,mHAAU,CAAC,QAAQ,CAAC,MAAM,CAAC,kBAAkB;YAChE,QAAQ;YACR,WAAW;YACX,WAAW;YACX,YAAY;YACZ,eAAe;QACjB;QACA,OAAO;YAAE,SAAS;YAAM,WAAW,OAAO,SAAS;QAAC;IACtD,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,CAAC,sBAAsB,EAAE,WAAW,CAAC,CAAC,EAAE;QACtD,OAAO;YAAE,SAAS;YAAO,OAAO,MAAM,OAAO;QAAC;IAChD;AACF","debugId":null}},
    {"offset": {"line": 65, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/IMAGE%20EDITOR/Image_Editor/backend/pages/api/organization/%5BorgName%5D/check.ts"],"sourcesContent":["import type { NextApiRequest, NextApiResponse } from 'next';\nimport cloudinary from '@/lib/cloudinary';\n\nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  if (req.method !== 'GET') {\n    res.setHeader('Allow', ['GET']);\n    return res.status(405).end(`Method ${req.method} Not Allowed`);\n  }\n\n  try {\n    const { orgName } = req.query;\n    \n    if (!orgName || typeof orgName !== 'string') {\n      return res.status(400).json({ error: 'Organization name is required' });\n    }\n    \n    // Try multiple methods to check if folder exists\n    let exists = false;\n    \n    // Method 1: Check if folder has any resources\n    try {\n      const searchResult = await cloudinary.search\n        .expression(`folder:${orgName}/*`)\n        .max_results(1)\n        .execute();\n      \n      if (searchResult.total_count > 0) {\n        exists = true;\n      }\n    } catch (searchError) {\n      // Search might fail if folder doesn't exist, continue to other methods\n    }\n    \n    // Method 2: Check for subfolders (editor or mindmapping)\n    if (!exists) {\n      try {\n        const subFolders = await cloudinary.api.sub_folders(orgName);\n        if (subFolders && subFolders.folders && subFolders.folders.length > 0) {\n          exists = true;\n        }\n      } catch (folderError) {\n        // Folder doesn't exist or no subfolders\n      }\n    }\n    \n    // Method 3: Check if folder exists at root level\n    if (!exists) {\n      try {\n        const rootFolders = await cloudinary.api.root_folders();\n        if (rootFolders && rootFolders.folders) {\n          const folderNames = rootFolders.folders.map((f: any) => f.name || f.path);\n          if (folderNames.includes(orgName)) {\n            exists = true;\n          }\n        }\n      } catch (rootError) {\n        // Couldn't check root folders\n      }\n    }\n    \n    res.json({ exists, organizationName: orgName });\n  } catch (error: any) {\n    console.error('Error checking organization:', error);\n    // Default to false if any error occurs\n    res.json({ exists: false, organizationName: req.query.orgName });\n  }\n}\n\n"],"names":[],"mappings":";;;;AACA;;AAEe,eAAe,QAC5B,GAAmB,EACnB,GAAoB;IAEpB,IAAI,IAAI,MAAM,KAAK,OAAO;QACxB,IAAI,SAAS,CAAC,SAAS;YAAC;SAAM;QAC9B,OAAO,IAAI,MAAM,CAAC,KAAK,GAAG,CAAC,CAAC,OAAO,EAAE,IAAI,MAAM,CAAC,YAAY,CAAC;IAC/D;IAEA,IAAI;QACF,MAAM,EAAE,OAAO,EAAE,GAAG,IAAI,KAAK;QAE7B,IAAI,CAAC,WAAW,OAAO,YAAY,UAAU;YAC3C,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO;YAAgC;QACvE;QAEA,iDAAiD;QACjD,IAAI,SAAS;QAEb,8CAA8C;QAC9C,IAAI;YACF,MAAM,eAAe,MAAM,gIAAU,CAAC,MAAM,CACzC,UAAU,CAAC,CAAC,OAAO,EAAE,QAAQ,EAAE,CAAC,EAChC,WAAW,CAAC,GACZ,OAAO;YAEV,IAAI,aAAa,WAAW,GAAG,GAAG;gBAChC,SAAS;YACX;QACF,EAAE,OAAO,aAAa;QACpB,uEAAuE;QACzE;QAEA,yDAAyD;QACzD,IAAI,CAAC,QAAQ;YACX,IAAI;gBACF,MAAM,aAAa,MAAM,gIAAU,CAAC,GAAG,CAAC,WAAW,CAAC;gBACpD,IAAI,cAAc,WAAW,OAAO,IAAI,WAAW,OAAO,CAAC,MAAM,GAAG,GAAG;oBACrE,SAAS;gBACX;YACF,EAAE,OAAO,aAAa;YACpB,wCAAwC;YAC1C;QACF;QAEA,iDAAiD;QACjD,IAAI,CAAC,QAAQ;YACX,IAAI;gBACF,MAAM,cAAc,MAAM,gIAAU,CAAC,GAAG,CAAC,YAAY;gBACrD,IAAI,eAAe,YAAY,OAAO,EAAE;oBACtC,MAAM,cAAc,YAAY,OAAO,CAAC,GAAG,CAAC,CAAC,IAAW,EAAE,IAAI,IAAI,EAAE,IAAI;oBACxE,IAAI,YAAY,QAAQ,CAAC,UAAU;wBACjC,SAAS;oBACX;gBACF;YACF,EAAE,OAAO,WAAW;YAClB,8BAA8B;YAChC;QACF;QAEA,IAAI,IAAI,CAAC;YAAE;YAAQ,kBAAkB;QAAQ;IAC/C,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,gCAAgC;QAC9C,uCAAuC;QACvC,IAAI,IAAI,CAAC;YAAE,QAAQ;YAAO,kBAAkB,IAAI,KAAK,CAAC,OAAO;QAAC;IAChE;AACF","debugId":null}}]
}